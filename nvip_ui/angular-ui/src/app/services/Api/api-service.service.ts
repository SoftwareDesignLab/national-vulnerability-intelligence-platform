import { Injectable } from '@angular/core';
import { HttpClient, HttpContext, HttpHeaders, HttpParams, HttpResponse } from "@angular/common/http";
import { Observer } from 'rxjs';
import { AuthCredentials } from '../Auth/auth-service.service';

/* Related Interfaces */

export interface HttpRequest {
  url: string;
  options: HttpRequestOptions;
}

export interface HttpRequestOptions {
  method: string;
  headers?: HttpHeaders | { [header: string]: string | string[]; } | undefined; 
  context?: HttpContext | undefined;
  params?: HttpRequestParams;
  reportProgress?: boolean;
  withCredentials?: boolean;
}

export type HttpRequestParams = 
  HttpParams | { [param: string]: string | number | boolean | ReadonlyArray<string | number | boolean>; }

export type ApiRequestObserver = Partial<Observer<Object>> | ((value: Object) => void);


@Injectable({
  providedIn: 'root'
})
export class ApiService{
  private GET_OPTIONS: HttpRequestOptions = {
    method: "GET",
  }


  constructor(private httpClient: HttpClient) { 

  }
  login(credentials: AuthCredentials, callback: ApiRequestObserver) {
    const request = this.httpClient.get("nvip_ui-1.0/loginServlet", this.injectGetParameters({...credentials}))
    request.subscribe(callback)
    
  }


  private injectGetParameters(params: HttpRequestParams) {
    return {...this.GET_OPTIONS, params: params}
  }
}

