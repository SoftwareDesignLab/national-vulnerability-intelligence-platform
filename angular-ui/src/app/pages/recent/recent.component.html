<div id="nvipContent" class="nvip-content-container">
  <div class="nvip-about-section col-12">
    <p>
      The National Vulnerability Intelligence Platform (NVIP) is a new
      generation vulnerability database, a public platform where the software
      development and security communities can obtain rich, actionable
      intelligence about known vulnerabilities. NVIP automates the collection of
      CVEs, providing near real-time publishing of vulnerabilities, as well as
      intelligent analysis and categorization of these vulnerabilities. This
      page provides a summary of the most recent vulnerabilities found by NVIP.
    </p>
  </div>
  <div class="nvip-daily-vuln-ctn col-12" ng-init="init()">
    <div class="nvip-loading-screen col-12" [hidden]="dailyVulns.length !== 0">
      <fa-icon
        [icon]="faSpinner"
        animation="spin"
        size="3x"
        [fixedWidth]="true"
        [ngStyle]="{ color: 'black' }"
      ></fa-icon>
      <span [ngStyle]="{ color: 'black' }"
        >Loading daily vulnerability data...</span
      >
    </div>
    <div
      class="nvip-daily-vuln-panel-ctn col-12"
      *ngFor="let vulnMap of dailyVulns; let panelIndex = index"
      [hidden]="panelIndex !== dailyVulnIndex"
    >
      <div class="nvip-daily-cve-panel-header col-8">
        <button
          class="nvip-button nvip-prev-day"
          (click)="incrementDailyVulnDay(-1)"
          [disabled]="dailyVulnIndex == 0"
          aria-label="Previous Day"
        >
          <div class="nvip-arrow-left"></div>
        </button>
        <div class="daily-cve-date col-12">
          <p>{{ vulnMap.date }}</p>
        </div>
        <div class="daily-cve-counts col-12">
          <p>{{ vulnMap.cve_list.length }} CVEs identified</p>
        </div>
        <button
          class="nvip-button nvip-next-day"
          (click)="incrementDailyVulnDay(1)"
          [disabled]="dailyVulnIndex == dailyVulns.length - 1"
          aria-label="Next Day"
        >
          <div class="nvip-arrow-right"></div>
        </button>
      </div>
      <div class="daily-cve-panel col-8">
        <p
          class="nvip-cve-panel-empty"
          [hidden]="vulnMap.cve_list.length !== 0"
        >
          No CVEs identified
        </p>
        <div class="daily-vuln-dropdown-container">
          <div
            class="daily-vuln-dropdown col-12"
            *ngFor="let vuln of vulnMap.cve_list; let vulnIndex = index"
          >
            <daily-vuln-dropdown
              [vuln]="vuln"
              [index]="vulnIndex"
              [currentToggle]="currentSelected"
              (selected)="setCurrentSelected($event)"
              *ngIf="vulnIndex < dailyVulnLimit[panelIndex]"
            ></daily-vuln-dropdown>
          </div>
        </div>
        <div class="nvip-daily-vuln-button-container col-11">
          <button
            class="nvip-button nvip-show-more"
            type="button"
            (click)="showMore(panelIndex)"
            [disabled]="isDisabled(true, panelIndex, vulnMap)"
          >
            <span>Show More</span>
          </button>
          <button
            class="nvip-button nvip-show-less"
            type="button"
            (click)="showLess(panelIndex)"
            [disabled]="isDisabled(false, panelIndex, vulnMap)"
          >
            <span>Show Less</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
